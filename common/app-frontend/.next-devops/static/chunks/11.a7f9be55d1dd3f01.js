"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[11],{5011:(e,a,t)=>{t.r(a),t.d(a,{default:()=>c});var n=t(5155),s=t(2115),i=t(5565);let l=(0,t(7401).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var r=t(1719),d=t(2651);function c(){let[e]=(0,s.useState)([{id:0,name:"Reset",stage:"One Day",index:0},{id:1,name:"Tour Down Under",stage:"Stage 6",index:5},{id:2,name:"Great Ocean Race",stage:"One Day",index:6},{id:3,name:"UAE Tour",stage:"Stage 7",index:13},{id:4,name:"Omloop Het Nieuwsblad",stage:"One Day",index:14},{id:5,name:"Strade Bianche",stage:"One Day",index:15},{id:6,name:"Paris-Nice",stage:"Stage 8",index:23},{id:7,name:"Tirreno-Adriatico",stage:"Stage 6",index:28},{id:8,name:"Milano-Sanremo",stage:"One Day",index:29},{id:9,name:"Volta a Catalunya",stage:"Stage 7",index:36},{id:10,name:"Classic Brugge-De Panne",stage:"One Day",index:37},{id:11,name:"E3 Harelbeke",stage:"One Day",index:38},{id:12,name:"Gent-Wevelgem",stage:"One Day",index:39},{id:13,name:"Dwars door Vlaanderen",stage:"One Day",index:40},{id:14,name:"Itzulia Basque Country",stage:"Stage 6",index:46},{id:15,name:"Amstel Gold Race",stage:"One Day",index:47},{id:16,name:"La Fl\xe8che Wallonne",stage:"One Day",index:48},{id:17,name:"Li\xe8ge-Bastogne-Li\xe8ge",stage:"One Day",index:49},{id:18,name:"Tour de Romandie",stage:"Stage 5",index:55},{id:19,name:"Eschborn-Frankfurt",stage:"One Day",index:56},{id:20,name:"Giro dâ€™Italia",stage:"Stage 21",index:76},{id:21,name:"Crit\xe9rium du Dauphin\xe9",stage:"Stage 8",index:84},{id:22,name:"Tour de Suisse",stage:"Stage 8",index:92},{id:23,name:"Tour de France",stage:"Stage 21",index:110},{id:24,name:"San Sebasti\xe1n",stage:"One Day",index:111},{id:25,name:"Tour de Pologne",stage:"Stage 7",index:118},{id:26,name:"Vuelta a Espa\xf1a",stage:"Stage 21",index:138},{id:27,name:"Bretagne Classic",stage:"One Day",index:139},{id:28,name:"Renewi Tour",stage:"Stage 5",index:142},{id:29,name:"Cyclassics Hamburg",stage:"One Day",index:143},{id:30,name:"Grand Prix Qu\xe9bec",stage:"One Day",index:144},{id:31,name:"Grand Prix Montr\xe9al",stage:"One Day",index:145},{id:32,name:"Il Lombardia",stage:"One Day",index:146},{id:33,name:"Tour of Guangxi",stage:"Stage 6",index:152}]),[a,t]=(0,s.useState)([]),[c,o]=(0,s.useState)(),[m,x]=(0,s.useState)("Stage 1"),[g,h]=(0,s.useState)([]),[u,p]=(0,s.useState)([]),[y,f]=(0,s.useState)(!1),[b,j]=(0,s.useState)(!1),[S,w]=(0,s.useState)(!1),[N,v]=(0,s.useState)(null),[D,O]=(0,s.useState)(!1),[k,C]=(0,s.useState)("");(0,s.useEffect)(()=>{R()},[]);let R=async()=>{try{let e=await d.A.get("http://seito.lavbic.net:5010/races");e.data.length>0&&""===k&&t(e.data)}catch(e){v("Failed to load races. Please try again."),console.error(e)}},P=async()=>{if(""===k){v("Please select a deployment index");return}w(!0),v(null);try{await d.A.post("http://seito.lavbic.net:5010/redeploy",{index:k}),await R(),window.location.reload()}catch(e){console.error("Redeployment failed:",e),v("Redeployment failed. Please try again.")}finally{w(!1)}},A=async e=>{if(o(e),f(!1),!e){console.error("No race selected");return}try{if("One_Day"===e.stage)h([]),await E(e.index);else if(e.stage.startsWith("Stage")){let t=a.filter(a=>a.name===e.name),n=Math.max(...t.map(e=>{let a=e.stage.match(/Stage (\d+)/);return a?parseInt(a[1],10):0})),s=Array.from({length:n},(e,a)=>"Stage ".concat(a+1));h(s),x("Stage 1");let i=t.find(e=>"Stage 1"===e.stage);i?await E(i.index):console.error("Could not find Stage 1 for race:",e.name)}}catch(e){console.error("Error in handleRaceChange:",e),v("Failed to load race predictions")}},T=e=>{x(e);let t=a.find(a=>a.name===(null==c?void 0:c.name)&&a.stage===e);t&&E(t.index)},E=async e=>{j(!0),v(null);try{let a=(await d.A.post("http://seito.lavbic.net:5010/predict",{index:e})).data.prediction.map((e,a)=>({id:a+1,name:e.name,winPercentage:(100*e.prediction).toFixed(2),imageUrl:e.image_url}));p(a)}catch(e){console.error("Error fetching predictions:",e),v("Failed to fetch predictions. Please try again."),p([])}finally{j(!1)}},F=D?u:u.slice(0,10);return(0,n.jsx)("div",{className:"min-h-screen bg-cover bg-center p-4",children:(0,n.jsx)("div",{className:"max-w-4xl mx-auto bg-white/95 backdrop-blur-sm rounded-lg shadow-lg",children:(0,n.jsxs)("div",{className:"p-6",children:[(0,n.jsxs)("div",{className:"flex flex-col space-y-4 mb-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold",children:"Cycling Race Predictor"}),(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("label",{htmlFor:"deploymentIndex",className:"text-sm font-medium text-gray-700",children:"Race to redeploy:"}),(0,n.jsxs)("select",{id:"deploymentIndex",value:k,onChange:e=>C(e.target.value?Number(e.target.value):""),className:"p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary",children:[(0,n.jsx)("option",{value:"",children:"Select race"}),e.map(e=>(0,n.jsxs)("option",{value:e.index,children:[e.id," - ",e.name]},e.index))]})]}),(0,n.jsxs)("button",{onClick:P,disabled:S||""===k,className:"flex items-center space-x-2 px-4 py-2 rounded-md text-white \n                    ".concat(S||""===k?"bg-gray-400":"bg-primary hover:bg-primary/90"),children:[(0,n.jsx)(l,{className:"h-5 w-5 ".concat(S?"animate-spin":"")}),(0,n.jsx)("span",{children:S?"Redeploying...":"Redeploy Model"})]})]})]}),N&&(0,n.jsx)("p",{className:"text-center text-red-500",children:N})]}),(0,n.jsxs)("div",{className:"relative mb-6",children:[(0,n.jsxs)("button",{onClick:()=>f(!y),className:"w-full p-2 bg-white border border-gray-300 rounded-md shadow-sm text-left flex justify-between items-center focus:outline-none focus:ring-2 focus:ring-primary","aria-haspopup":"listbox","aria-expanded":y,children:[(0,n.jsx)("span",{className:"block truncate",children:c?c.name:"Select a race"}),(0,n.jsx)(r.A,{className:"h-5 w-5 text-gray-400 transform ".concat(y?"rotate-180":""),"aria-hidden":"true"})]}),y&&(0,n.jsx)("ul",{className:"absolute z-10 mt-2 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none sm:text-sm",role:"listbox",children:Array.from(new Set(a.map(e=>e.name))).map(e=>{let t=a.find(a=>a.name===e);return t?(0,n.jsx)("li",{className:"cursor-pointer select-none relative py-2 pl-3 pr-9 hover:bg-primary hover:text-white ".concat(e===(null==c?void 0:c.name)?"bg-primary text-white":"text-gray-900"),onClick:()=>A(t),role:"option",children:e},e):null})})]}),g.length>0&&(0,n.jsxs)("div",{className:"relative mb-6",children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Stage"}),(0,n.jsx)("select",{value:m,onChange:e=>T(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary",children:g.map((e,a)=>(0,n.jsx)("option",{value:e,children:e},a))})]}),b&&(0,n.jsx)("p",{className:"text-center",children:"Loading predictions..."}),N&&(0,n.jsx)("p",{className:"text-center text-red-500",children:N}),c&&u.length>0&&!b&&(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold",children:"Cyclists"}),(0,n.jsx)("button",{onClick:()=>O(!D),className:"p-1 px-4 bg-primary text-white rounded-md",children:D?"Show Top 10":"Show All"})]}),(0,n.jsxs)("table",{className:"w-full",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:"bg-gray-100",children:[(0,n.jsx)("th",{className:"p-2 text-left",children:"Rank"}),(0,n.jsx)("th",{className:"p-2 text-left",children:"Cyclist"}),(0,n.jsx)("th",{className:"p-2 text-left",children:"Win Likelihood"})]})}),(0,n.jsx)("tbody",{children:F.map((e,a)=>(0,n.jsxs)("tr",{className:"border-b",children:[(0,n.jsx)("td",{className:"p-2",children:a+1}),(0,n.jsx)("td",{className:"p-2",children:(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(i.default,{src:e.imageUrl,alt:"".concat(e.name,"'s avatar"),width:40,height:40,className:"rounded-full"}),(0,n.jsx)("span",{children:e.name})]})}),(0,n.jsxs)("td",{className:"p-2",children:[e.winPercentage,"%"]})]},e.id))})]})]})]})})})}}}]);