(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[333],{8388:(e,t,a)=>{Promise.resolve().then(a.bind(a,8097))},8097:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var s=a(5155),l=a(2115),r=a(5565),n=a(2817),i=a(2651);function c(){let[e,t]=(0,l.useState)([]),[a,c]=(0,l.useState)(),[o,d]=(0,l.useState)("Stage 1"),[m,h]=(0,l.useState)([]),[x,u]=(0,l.useState)([]),[g,p]=(0,l.useState)(!1),[f,b]=(0,l.useState)(!1),[j,N]=(0,l.useState)(null),[w,y]=(0,l.useState)(!1);(0,l.useEffect)(()=>{i.A.get("http://seito.lavbic.net:15000/races").then(e=>{t(e.data)}).catch(e=>{N("Failed to load races. Please try again."),console.error(e)})},[]);let v=async t=>{if(c(t),p(!1),!t){console.error("No race selected");return}try{if("One_Day"===t.stage)h([]),await k(t.index);else if(t.stage.startsWith("Stage")){let a=e.filter(e=>e.name===t.name),s=Math.max(...a.map(e=>{let t=e.stage.match(/Stage (\d+)/);return t?parseInt(t[1],10):0})),l=Array.from({length:s},(e,t)=>"Stage ".concat(t+1));h(l),d("Stage 1");let r=a.find(e=>"Stage 1"===e.stage);r?await k(r.index):console.error("Could not find Stage 1 for race:",t.name)}}catch(e){console.error("Error in handleRaceChange:",e),N("Failed to load race predictions")}},S=t=>{d(t);let s=e.find(e=>e.name===(null==a?void 0:a.name)&&e.stage===t);s&&k(s.index)},k=async e=>{b(!0),N(null);try{let t=(await i.A.post("http://seito.lavbic.net:15000/predict",{index:e})).data.prediction.map((e,t)=>({id:t+1,name:e.name,winPercentage:(100*e.prediction).toFixed(2),imageUrl:e.image_url}));u(t)}catch(e){console.error("Error fetching predictions:",e),N("Failed to fetch predictions. Please try again."),u([])}finally{b(!1)}},C=w?x:x.slice(0,10);return(0,s.jsx)("div",{className:"min-h-screen bg-cover bg-center p-4",children:(0,s.jsx)("div",{className:"max-w-4xl mx-auto bg-white/95 backdrop-blur-sm rounded-lg shadow-lg",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-center mb-6",children:"Cycling Race Predictor"}),(0,s.jsxs)("div",{className:"relative mb-6",children:[(0,s.jsxs)("button",{onClick:()=>p(!g),className:"w-full p-2 bg-white border border-gray-300 rounded-md shadow-sm text-left flex justify-between items-center focus:outline-none focus:ring-2 focus:ring-primary","aria-haspopup":"listbox","aria-expanded":g,children:[(0,s.jsx)("span",{className:"block truncate",children:a?a.name:"Select a race"}),(0,s.jsx)(n.A,{className:"h-5 w-5 text-gray-400 transform ".concat(g?"rotate-180":""),"aria-hidden":"true"})]}),g&&(0,s.jsx)("ul",{className:"absolute z-10 mt-2 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none sm:text-sm",role:"listbox",children:Array.from(new Set(e.map(e=>e.name))).map(t=>{let l=e.find(e=>e.name===t);return l?(0,s.jsx)("li",{className:"cursor-pointer select-none relative py-2 pl-3 pr-9 hover:bg-primary hover:text-white ".concat(t===(null==a?void 0:a.name)?"bg-primary text-white":"text-gray-900"),onClick:()=>v(l),role:"option",children:t},t):null})})]}),m.length>0&&(0,s.jsxs)("div",{className:"relative mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Stage"}),(0,s.jsx)("select",{value:o,onChange:e=>S(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary",children:m.map((e,t)=>(0,s.jsx)("option",{value:e,children:e},t))})]}),f&&(0,s.jsx)("p",{className:"text-center",children:"Loading predictions..."}),j&&(0,s.jsx)("p",{className:"text-center text-red-500",children:j}),a&&x.length>0&&!f&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Cyclists"}),(0,s.jsx)("button",{onClick:()=>y(!w),className:"p-1 px-4 bg-primary text-white rounded-md",children:w?"Show Top 10":"Show All"})]}),(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"bg-gray-100",children:[(0,s.jsx)("th",{className:"p-2 text-left",children:"Rank"}),(0,s.jsx)("th",{className:"p-2 text-left",children:"Cyclist"}),(0,s.jsx)("th",{className:"p-2 text-left",children:"Win Likelihood"})]})}),(0,s.jsx)("tbody",{children:C.map((e,t)=>(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsx)("td",{className:"p-2",children:t+1}),(0,s.jsx)("td",{className:"p-2",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(r.default,{src:e.imageUrl,alt:"".concat(e.name,"'s avatar"),width:40,height:40,className:"rounded-full"}),(0,s.jsx)("span",{children:e.name})]})}),(0,s.jsxs)("td",{className:"p-2",children:[e.winPercentage,"%"]})]},e.id))})]})]})]})})})}let o=()=>(0,s.jsx)(c,{})}},e=>{var t=t=>e(e.s=t);e.O(0,[539,441,517,358],()=>t(8388)),_N_E=e.O()}]);